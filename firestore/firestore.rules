rules_version = "2";
service cloud.firestore {
  match /databases/{database}/documents {
    match /profiles/{profileId} {
      allow get;
      allow list:
        if request.query.limit == 1;
      allow update:
        if request.auth.uid != null
        && request.auth.uid == profileId
        && request.resource.data.diff(resource.data).affectedKeys().hasOnly(["bio", "name", "namespaceId", "photo", "social"]);
      allow create, delete:
        if false;
    }
  }
}
